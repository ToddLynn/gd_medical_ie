(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-67fb2354"],{"450a":function(t,e,a){},"83f3":function(t,e,a){"use strict";a("450a")},9406:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-row",{staticClass:"search-row"},[a("el-input",{model:{value:t.searchRow.from,callback:function(e){t.$set(t.searchRow,"from",e)},expression:"searchRow.from"}}),a("svg-icon",{staticClass:"icon-space-between",attrs:{"icon-class":"double-headed-arrow"}}),a("el-input",{model:{value:t.searchRow.to,callback:function(e){t.$set(t.searchRow,"to",e)},expression:"searchRow.to"}}),a("el-button",{staticClass:"button-transform",attrs:{type:"primary"},on:{click:t.doExchange}},[a("span",[t._v("转换")])]),a("el-button",{on:{click:t.reset}},[a("span",[t._v("重置")])])],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-tabs",{staticClass:"main-card",attrs:{type:"border-card"},model:{value:t.leftTabs,callback:function(e){t.leftTabs=e},expression:"leftTabs"}},[a("el-tab-pane",{attrs:{name:"text"}},[a("span",{staticClass:"tab-label",attrs:{slot:"label"},slot:"label"},[a("svg-icon",{attrs:{"icon-class":"tab-text"}}),t._v(" 文本内容 ")],1),a("label",[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.transformText,expression:"transformText"}],staticClass:"textarea-no-border",attrs:{rows:t.rows,placeholder:"请输入文本内容"},domProps:{value:t.transformText},on:{input:function(e){e.target.composing||(t.transformText=e.target.value)}}})])]),a("el-tab-pane",{attrs:{name:"annotator"}},[a("span",{staticClass:"tab-label",attrs:{slot:"label"},slot:"label"},[a("svg-icon",{attrs:{"icon-class":"tab-analyze"}}),t._v(" 知识分析 ")],1),a("div",{style:{height:t.win.height-260+"px","min-height":"520px",width:"100%"},attrs:{id:"content"}})])],1)],1),a("el-col",{attrs:{span:12}},[a("el-tabs",{staticClass:"main-card",attrs:{type:"border-card"}},[a("el-tab-pane",[a("span",{staticClass:"tab-label",attrs:{slot:"label"},slot:"label"},[a("svg-icon",{attrs:{"icon-class":"tab-structured"}}),t._v(" 大纲式结构化 ")],1),a("el-empty",{directives:[{name:"show",rawName:"v-show",value:!t.treeDataFormatted,expression:"!treeDataFormatted"}],attrs:{description:"暂无数据"}}),a("div",{staticClass:"custom-card-body"},t._l(t.treeDataFormatted,(function(e,n){return a("el-row",{key:"tree_"+n},[a("div",{staticClass:"custom-tree-node",on:{click:function(e){return t.treeFoldChange(n)}}},[t.treeFold[n]?t._e():a("i",{staticClass:"el-icon-caret-bottom",staticStyle:{"margin-right":"10px"}}),t.treeFold[n]?a("i",{staticClass:"el-icon-caret-right",staticStyle:{"margin-right":"10px"}}):t._e(),t._v(" "+t._s(e.label)+" ")]),t._l(e.children,(function(e,o){return a("div",{directives:[{name:"show",rawName:"v-show",value:!t.treeFold[n],expression:"!treeFold[index]"}],key:"treeItem_"+o},[a("div",{staticClass:"custom-tree-node"},[a("div",{staticClass:"custom-tree-dashed"}),a("div",{staticClass:"custom-tree-node-point"}),a("span",{staticClass:"sub-text"},[t._v(" "+t._s(e.label)+" ")]),t._v("："+t._s(e.value)+" ")])])}))],2)})),1)],1),a("el-tab-pane",[a("span",{staticClass:"tab-label",attrs:{slot:"label"},slot:"label"},[a("svg-icon",{staticStyle:{color:"#1890fe"},attrs:{"icon-class":"tab-table"}}),t._v(" 表格式结构化 ")],1),a("div",{staticClass:"custom-card-body"},[a("el-row",[a("el-col",{staticClass:"structured-item-title",attrs:{span:7}},[t._v(" 模块 ")]),a("el-col",{staticClass:"structured-item-title",attrs:{span:7}},[t._v(" 属性 ")]),a("el-col",{staticClass:"structured-item-title",attrs:{span:10}},[t._v(" 值 ")])],1),a("el-empty",{directives:[{name:"show",rawName:"v-show",value:!t.treeDataFormatted,expression:"!treeDataFormatted"}],attrs:{description:"暂无数据"}}),t._l(t.treeDataFormatted,(function(e,n){return a("el-row",{key:"model_"+n},[a("el-col",{staticClass:"structured-item",style:{height:40*e.children.length+"px"},attrs:{span:7}},[t._v(" "+t._s(e.label)+" ")]),t._l(e.children,(function(e,n){return a("div",{key:"atrr_"+n},[a("el-col",{staticClass:"structured-item",staticStyle:{height:"40px"},attrs:{span:7}},[t._v(" "+t._s(e.label)+" ")]),a("el-col",{staticClass:"structured-item",staticStyle:{height:"40px"},attrs:{span:10}},[t._v(" "+t._s(e.value)+" ")])],1)}))],2)}))],2)])],1)],1)],1)],1)],1)},o=[],r=a("53ca"),s=(a("e9c4"),a("d3b7"),a("159b"),a("4de4"),a("7db0"),a("b64b"),a("cb29"),a("25f0"),a("b775"));function l(t){return Object(s["a"])({url:"medical_ie",method:"post",transformRequest:[function(t){var e="";for(var a in t)e+=encodeURIComponent(a)+"="+encodeURIComponent(t[a])+"&";return e=e.substring(0,e.lastIndexOf("&")),e}],headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{medical_content:t}})}var i=a("a21c"),c=a("61f7"),u=a("ec26"),d={name:"Dashboard",data:function(){return{searchRow:{from:"知识文本",to:"结构化"},transformText:"",win:{height:null},resultInfo:{content:"",connections:[],connectionCategories:[],labels:[],labelCategories:[]},annotatorNode:null,treeDataFormatted:null,treeData:{},treeFold:[],leftTabs:"text"}},computed:{rows:function(){return this.win.height<500?17:this.win.height<770?Math.floor(this.win.height/50):this.win.height<880?Math.floor((this.win.height-50)/45):Math.floor((this.win.height-50)/40)}},watch:{"resultInfo.content":{immediate:!0,handler:function(t){this.annotatorNode&&this.annotatorNode.remove(),t&&this.resultInfo&&this.resultInfo.labelCategories.length>0&&this.$nextTick((function(){this.annotatorInit()}))}}},created:function(){this.win.height=window.innerHeight},mounted:function(){var t=this;window.onresize=function(){t.$nextTick((function(){console.log("window.innerHeight",window.innerHeight),this.win.height=window.innerHeight}))}},methods:{reset:function(){this.annotatorNode&&this.annotatorNode.remove(),this.resultInfo={content:"",connections:[],connectionCategories:[],labels:[],labelCategories:[]},this.treeDataFormatted=null,this.transformText=""},doExchange:function(){var t=this;if(this.transformText){var e=JSON.parse(JSON.stringify(this.transformText));this.reset(),this.transformText=e,l(e).then((function(e){t.treeData=e.data.output_dict,t.leftTabs="annotator",t.treeDataFormatter(t.treeData),t.annotartorFormatter(e.data.annotation)}))}},annotatorInit:function(){console.log("-------this.resultInfo",this.resultInfo),this.resultInfo.labelCategories&&this.resultInfo.content&&(this.annotatorNode=new i["Annotator"](this.resultInfo,document.getElementById("content")))},annotartorFormatter:function(t){var e=this,a={content:t.text,labels:[],tempLabels:[],labelCategories:[],connections:[],tempConnections:[],connectionCategories:[]};t.spo_list.forEach((function(t){var n={id:"lc_"+Object(u["a"])(),text:t.object_type["@value"],color:e.randomHexColor(),borderColor:"#a38671"};a.labelCategories.filter((function(t){return t.text===n.text})).length<=0&&a.labelCategories.push(n);var o={id:"lc_"+Object(u["a"])(),text:t.subject_type,color:e.randomHexColor(),borderColor:"#a38671"};a.labelCategories.filter((function(t){return t.text===o.text})).length<=0&&a.labelCategories.push(o);var r={id:"c_"+Object(u["a"])(),category:t.predicate,categoryId:"",from:t.object["@value"],fromId:null,to:t.subject,toId:null};a.tempConnections.push(r);var s={id:"cc_"+Object(u["a"])(),text:t.predicate};a.connectionCategories.push(s);var l={id:"l_"+Object(u["a"])(),category:t.subject_type,categoryId:null,startIndex:null,endIndex:null,text:t.subject};a.tempLabels.filter((function(t){return t.text===l.text})).length<=0&&a.tempLabels.push(l);var i={id:"l_"+Object(u["a"])(),category:t.object_type["@value"],categoryId:null,startIndex:null,endIndex:null,text:t.object["@value"]};a.tempLabels.filter((function(t){return t.text===i.text})).length<=0&&a.tempLabels.push(i)})),a.tempLabels.forEach((function(t){var e=Object(c["a"])(a.content,t.text),n=a.labelCategories.find((function(e){return e.text===t.category}));e.forEach((function(e){var o={id:"l_"+Object(u["a"])(),categoryId:n.id,startIndex:e.start,endIndex:e.end,text:t.text};a.labels.push(o)}))})),a.tempConnections.forEach((function(t){var e=a.connectionCategories.find((function(e){return e.text===t.category}));if(t.categoryId=e.id,null!==t.form&&null!==t.to){var n=a.labels.filter((function(e){return e.text===t.from})),o=a.labels.filter((function(e){return e.text===t.to}));console.log("---temp---",t,n,o)}}));var n=this;setTimeout((function(){n.resultInfo=JSON.parse(JSON.stringify(a))}),10)},treeFoldChange:function(t){this.treeFold[t]=!this.treeFold[t],this.treeFold=JSON.parse(JSON.stringify(this.treeFold))},treeDataFormatter:function(t){var e=this,a=[];Object.keys(t).forEach((function(n){e.formatter(n,t[n]),a.push(e.formatter(n,t[n]))})),this.treeDataFormatted=a,this.treeFold.length=a.length,this.treeFold.fill(!1)},formatter:function(t,e){var a=this;if(null===e)return{label:t,value:""};if("object"===Object(r["a"])(e)){var n=[];return Object.keys(e).forEach((function(t){n.push(a.formatter(t,e[t]))})),{label:t,children:n}}return"string"===typeof e?{label:t,value:e}:void 0},randomHexColor:function(){var t=Math.floor(16777216*Math.random()).toString(16);while(t.length<6)t="0"+t;return"#"+t},test:function(t){return!this.treeFold[t]}}},h=d,f=(a("83f3"),a("2877")),b=Object(f["a"])(h,n,o,!1,null,"1f02d413",null);e["default"]=b.exports}}]);